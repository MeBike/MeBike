enum FixedSlotStatus {
  ACTIVE
  CANCELLED
}


model FixedSlotTemplate {
  id         String          @id @default(uuid(7)) @db.Uuid
  userId     String          @db.Uuid @map("user_id")
  stationId  String          @db.Uuid @map("station_id")
  slotStart  DateTime        @db.Time @map("slot_start")
  status     FixedSlotStatus @default(ACTIVE)
  createdAt  DateTime        @default(now()) @db.Timestamptz @map("created_at")
  updatedAt  DateTime        @default(now()) @db.Timestamptz @map("updated_at")

  user       User            @relation(fields: [userId], references: [id])
  station    Station         @relation(fields: [stationId], references: [id])
  dates      FixedSlotDate[]
  reservations Reservation[]

  @@index([userId], name: "idx_fixed_slot_user")
  @@index([stationId], name: "idx_fixed_slot_station")
  @@index([status], name: "idx_fixed_slot_status")
}

model FixedSlotDate {
  id          String    @id @default(uuid(7)) @db.Uuid
  templateId  String    @db.Uuid @map("template_id")
  slotDate    DateTime  @db.Date @map("slot_date")

  template    FixedSlotTemplate @relation(fields: [templateId], references: [id], onDelete: Cascade)

  @@unique([templateId, slotDate], name: "uq_fixed_slot_date")
  @@index([templateId], name: "idx_fixed_slot_dates_template")
  @@index([slotDate], name: "idx_fixed_slot_dates_date")
}
