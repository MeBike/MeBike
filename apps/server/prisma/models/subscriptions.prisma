enum SubscriptionStatus {
  PENDING
  ACTIVE
  EXPIRED
  CANCELLED
}

enum SubscriptionPackage {
  basic
  premium
  unlimited
}


model Subscription {
  id          String              @id @default(uuid(7)) @db.Uuid
  userId      String              @map("user_id") @db.Uuid
  packageName SubscriptionPackage @map("package_name")
  maxUsages   Int?
  usageCount  Int                 @default(0) @map("usage_count")
  status      SubscriptionStatus  @default(PENDING)
  activatedAt DateTime?           @map("activated_at") @db.Timestamptz
  expiresAt   DateTime?           @map("expires_at") @db.Timestamptz
  price       Decimal             @db.Decimal(12, 2)
  updatedAt   DateTime            @default(now()) @map("updated_at") @db.Timestamptz

  user         User          @relation(fields: [userId], references: [id])
  reservations Reservation[]
  rentals      Rental[]
  // Partial unique index for active subscriptions per user cannot be expressed in Prisma:
  // CREATE UNIQUE INDEX idx_subscriptions_active_user ON "Subscription"("user_id") WHERE status = 'ACTIVE';

  @@index([userId], name: "idx_subscriptions_user")
  @@index([status], name: "idx_subscriptions_status")
  @@index([expiresAt], name: "idx_subscriptions_expires")
}
