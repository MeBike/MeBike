enum WalletHoldStatus {
  ACTIVE
  RELEASED
  SETTLED
}

enum WalletHoldReason {
  WITHDRAWAL
}

model WalletHold {
  id           String           @id @default(uuid(7)) @db.Uuid
  walletId     String           @map("wallet_id") @db.Uuid
  withdrawalId String           @unique @map("withdrawal_id") @db.Uuid
  amount       BigInt           @db.BigInt
  status       WalletHoldStatus @default(ACTIVE)
  reason       WalletHoldReason @default(WITHDRAWAL)
  releasedAt   DateTime?        @map("released_at") @db.Timestamptz
  settledAt    DateTime?        @map("settled_at") @db.Timestamptz
  createdAt    DateTime         @default(now()) @map("created_at") @db.Timestamptz
  updatedAt    DateTime         @updatedAt @map("updated_at") @db.Timestamptz

  wallet     Wallet           @relation(fields: [walletId], references: [id])
  withdrawal WalletWithdrawal @relation(fields: [withdrawalId], references: [id])

  @@index([walletId], name: "idx_wallet_holds_wallet")
  @@index([status, createdAt], name: "idx_wallet_holds_status_created_at")
  @@map("wallet_holds")
}
